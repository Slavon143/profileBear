jQuery(document).ready(function(e){var t=e(".wc-svea-checkout-page");if(!(t.length<=0)){var o=function(){this.init()};o.prototype={scoOrderId:!1,scoAPIEnabled:!1,init:function(){this.scoOrderId=t.data("sco-order-id")||!1,window.setInterval(this.heartbeat,6e5),this.attachEvents()},updateFragments:function(t){e.each(t,function(t,o){e(t).replaceWith(o),e(t).unblock()})},heartbeat:function(){var t={security:wc_sco_params.sco_heartbeat_nonce};e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","sco_heartbeat"),data:t,success:function(e){if("true"===e.reload)return void window.location.reload()}})},saveOrderInformation:function(){var t=this,o={security:wc_sco_params.update_sco_order_information,form_data:e(".wc-svea-checkout-form").serialize()};e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","update_sco_order_information"),data:o,success:function(e){e&&e.fragments&&t.updateFragments(e.fragments)}})},observeSveaData:function(){var t=this;"1"===wc_sco_params.sync_zip_code&&window.scoApi.observeEvent("identity.postalCode",function(o){var c=o.value||"";if(!(c.length<=0)){var a=e("#billing_postcode").val();a!==c&&(e("#billing_postcode").val(c),t.refreshData())}})},attachSveaEvents:function(){var t=this,o=function(){"scoApi"in window&&(t.scoAPIEnabled=!0,t.observeSveaData(),e(document).on("checkoutReady",function(){"scoApi"in window&&t.observeSveaData()}))};"scoApi"in window?o():e(document).one("checkoutReady",o)},blockCheckout:function(t){t?e(".wc-svea-checkout-page").addClass("updating"):e(".wc-svea-checkout-page").removeClass("updating")},setCheckoutUpdating:function(e){e?(this.blockCheckout(!0),this.scoAPIEnabled&&window.scoApi.setCheckoutEnabled(!1)):(this.blockCheckout(!1),this.scoAPIEnabled&&window.scoApi.setCheckoutEnabled(!0))},attachCheckoutEvents:function(){var t=this;this.currentCountry=e(".wc-svea-checkout-page #billing_country").val(),e(document).on("change",".wc-svea-checkout-page #billing_country",function(o){var c=e(".wc-svea-checkout-page #billing_country").val();t.currentCountry!=c&&(t.refreshData(),t.currentCountry=c)}),e(document).on("change",".wc-svea-checkout-page #shipping_method .shipping_method",function(e){t.refreshData()}),e(document).on("sco_refresh_data",function(e){t.refreshData()}),e(document).on("change",".wc-svea-checkout-page .wc-svea-checkout-form",function(e){t.saveOrderInformation()}),e(document).on("sco_save_order_information",function(e){t.saveOrderInformation()}),e("body").on("update_checkout",function(){t.refreshData()})},attachEvents:function(){this.attachSveaEvents(),this.attachCheckoutEvents()},refreshData:function(){var t=this,o={security:wc_sco_params.refresh_sco_snippet_nonce,country:e("#billing_country").val(),postcode:e("#billing_postcode").val(),post_data:e(".wc-svea-checkout-form").serialize()},c={};e('select.shipping_method, input[name^="shipping_method"][type="radio"]:checked, input[name^="shipping_method"][type="hidden"]').each(function(){c[e(this).data("index")]=e(this).val()}),o.shipping_method=c,t.setCheckoutUpdating(!0),e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","refresh_sco_snippet"),data:o,success:function(o){if("true"===o.reload)return void window.location.reload();e(".woocommerce-NoticeGroup-updateOrderReview").remove(),o&&o.fragments&&t.updateFragments(o.fragments);var c=o.sco_order_id||!1;if(c==t.scoOrderId&&t.scoAPIEnabled||(t.scoOrderId=c,"sco_snippet"in o&&(e(".wc-svea-checkout-checkout-module").replaceWith(o.sco_snippet),e(".wc-svea-checkout-checkout-module").unblock())),"failure"===o.result){var a=e(".wc-svea-checkout-page");e(".woocommerce-error, .woocommerce-message").remove(),o.messages?a.prepend('<div class="woocommerce-NoticeGroup-updateOrderReview">'+o.messages+"</div>"):a.prepend(o),a.find(".input-text, select, input:checkbox").blur(),e("html, body").animate({scrollTop:a.offset().top-100},1e3)}e(document.body).trigger("updated_checkout",[o]),t.setCheckoutUpdating(!1)},error:function(e,t,o){window.location.reload()}})}},new o}});